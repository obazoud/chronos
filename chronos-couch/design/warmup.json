{"_id": "_design/app","updates": { "warmup": "function (doc, req) {   if(doc.gamers==0 || doc.gamers==null){ doc.maxGamers= parseInt(req.query.maxGamers);   doc.warmupStart = new Date().getTime(); doc.warmupEnd = doc.warmupStart + parseInt(req.query.warmupDuration);         doc.gamers = 1;         return [doc,\"start\"];     }else{         if(new Date().getTime() < doc.warmupEnd && (doc.gamers + 1) <= doc.maxGamers){  doc.gamers = doc.gamers + 1;  return [doc,\"continue\"];         }else{             return [doc,\"end\"]; } } }"   }}